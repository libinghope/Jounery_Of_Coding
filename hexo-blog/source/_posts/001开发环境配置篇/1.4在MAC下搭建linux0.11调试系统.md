---
date: now
comments: true
categories:
  - 开发环境
tags:
  - 开发
  - linux
  - 调试
permalink: '1.4'
title: 使用bochs在MAC下搭建linux0.11调试环境
description: 在MAC系统下，使用SDL2,Bochs虚拟机加载运行调试linux0.11的源码
---
步骤如下:

## 1、安装SDL2.0

建议使用brew安装: brew install sdl2;也可以去[SDL网站](http://www.libsdl.org/download-1.2.php "SDL下载")，下载最新版本的源代码，自行安装。  
安装brew时候踩到坑了，记录到在[MAC系统的使用](https://libinghope.github.io/journey-of-coding/1.3/ "MAC系统的使用")这篇文章了。

## 2、安装Bochs

去官网下载[bochs-2.6.8.tar.gz](https://sourceforge.net/projects/bochs/files/bochs/2.6.8/bochs-2.6.8.tar.gz/download "bochs-2.6.8.tar.gz")  
解压tar -xvf bochs-2.6.8.tar.gz  
进入刚才解压的目录  cd bochs-2.6.8  
执行如下配置:  

```shell
./configure --enable-ne2000 \
           --enable-all-optimizations \
           --enable-cpu-level=6 \
           --enable-x86-64 \
           --enable-vmx=2 \
           --enable-pci \
           --enable-usb \
           --enable-usb-ohci \
           --enable-e1000 \
           --enable-debugger \
           --enable-disasm \
           --disable-debugger-gui \
           --with-sdl \
           --prefix=$HOME/opt/bochs
```

执行安装命令  

>
make
make install

## 3、在make的过程中出现两个错误

1、报这个错
>cdrom_osx.cc:194:18: error: assigning to 'char ' from incompatible type 'const ch

解决办法:在当前目录(bochs源码目录)下搜索cdrom_osx.cc文件，找到这个文件后用任意文本编辑器打开，搜索

>if ((devname = strrchr(devpath, '/')) != NULL) {

替换成

>if ((devname = (char *) strrchr(devpath, '/')) != NULL) {

2、之后报第二个错

>config.cc:3261:55: error: ordered comparison between pointer and zero ('char *' and 'int')
    if (SIM->get_param_string("model", base)->getptr()>0) {
1 error generated.
>
根刚才第一个问题一样的处理方式，找到文件config.cc，定位到3261行，做如下修改  
>
>//if (SIM->get_param_string("model", base)->getptr()>0) {  
if (SIM->get_param_string("model", base)->getptr()>(char *)0) {  

这样就可以安装成功了。

## 4、下载使用Linux0.11镜像
